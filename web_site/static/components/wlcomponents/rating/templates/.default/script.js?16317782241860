class RatingComponent {
    constructor(params) {
        let self = this;
        this.params = params;

        this.load();

        $(this.params.component_id).on('click', '.js-rating-increase', function () {
            self.increase(this);
            return false;
        });

        $(this.params.component_id).on('click', '.js-rating-reduce', function () {
            self.reduce(this);
            return false;
        });
    }

    load(){
        let self = this;
        $.ajax("/local/components/wlcomponents/rating/ajax/", {
            method: 'POST',
            data: {
                action: 'load',
                hash: this.params.hash
            },
            dataType: 'json',
            crossDomain: true,
            success: function (response) {
                $(self.params.component_id).html(response.html);
            }
        });
    }

    increase(element) {
        let self = this;
        $(element).addClass('active');
        $.ajax("/local/components/wlcomponents/rating/ajax/", {
            method: 'POST',
            data: {
                action: 'increase',
                hash: this.params.hash
            },
            dataType: 'json',
            crossDomain: true,
            success: function (response) {
                self.load();
            }
        });
    }

    reduce(element) {
        let self = this;
        $(element).addClass('active');
        $.ajax("/local/components/wlcomponents/rating/ajax/", {
            method: 'POST',
            data: {
                action: 'reduce',
                hash: this.params.hash
            },
            dataType: 'json',
            crossDomain: true,
            success: function (response) {
                self.load();
            }
        });
    }
}

